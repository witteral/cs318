YUI.add("search-content-picker-view",function(e){var t=[{intlKey:"search.PHOTOS",titleIntlKey:"search.PHOTOS",value:"photos",selected:!0},{intlKey:"search.VIDEOS",titleIntlKey:"search.VIDEOS",value:"videos",selected:!0}];e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(s){var n,i,a=this;return this.searchUrl=s.searchUrl||new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),n=this.searchUrl.getAPIParam(e.SearchHelper.API.mediaType),this.selectedContents=[],this.contents=[],t.forEach(function(t){i=e.merge(t),n&&(i.selected=n===t.value||"all"===n),i.selected&&a.selectedContents.push(i.value),a.contents.push(i)}),this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("search-content-picker",{contents:this.contents}),this.updateContainerDisabledState(),this},activate:function(){return this.registerEventHandler(this.get("container").delegate("click",this.handleContentClick.bind(this),".content-button")),this.registerEventHandler(this.get("container").delegate("key",this.handleContentClick.bind(this),"down:13",".content-button")),this},handleContentClick:function(t){var s=t.target.getData("content-value"),n=this.selectedContents.indexOf(s);if(t.halt(),-1===n)this.selectedContents.push(s),t.target.addClass("checked"),this.updateContainerDisabledState();else{if(this.isContainerDisabled())return;this.selectedContents.splice(n,1),t.target.removeClass("checked"),this.updateContainerDisabledState()}!this.selectedContents.length||this.isDefaultValue()?this.searchUrl.removeAPIParam(e.SearchHelper.API.mediaType):this.searchUrl.setAPIParam(e.SearchHelper.API.mediaType,this.selectedContents[0]),this.fire("subviewViewEvent","search:urlUpdate",this.searchUrl)},updateContainerDisabledState:function(){this.selectedContents.length<=1?this.get("container").addClass("disabled"):this.get("container").removeClass("disabled")},isContainerDisabled:function(){return!!this.get("container").hasClass("disabled")},isDefaultValue:function(){return this.selectedContents&&this.selectedContents.length===t.length}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-content-picker","search-helper","search-url"],langBundles:["search"]});YUI.add("hermes-template-search-search-in-picker",function(e,a){var n=e.Template.Handlebars.revive({1:function(e,a,n,l,s){var t,i=null!=a?a:{},r=n.helperMissing,u=e.escapeExpression;return'\t\t<li class="search-in-button'+(null!=(t=n.if.call(i,null!=a?a.isFirst:a,{name:"if",hash:{},fn:e.program(2,s,0),inverse:e.noop,data:s}))?t:"")+(null!=(t=n.if.call(i,null!=a?a.isLast:a,{name:"if",hash:{},fn:e.program(4,s,0),inverse:e.noop,data:s}))?t:"")+(null!=(t=n.if.call(i,null!=a?a.selected:a,{name:"if",hash:{},fn:e.program(6,s,0),inverse:e.noop,data:s}))?t:"")+' tabbable"'+(null!=(t=n.if.call(i,null!=a?a.value:a,{name:"if",hash:{},fn:e.program(8,s,0),inverse:e.noop,data:s}))?t:"")+' data-tooltip-title="'+u((n.intlMessage||a&&a.intlMessage||r).call(i,{name:"intlMessage",hash:{intlName:null!=a?a.titleIntlKey:a},data:s}))+'" data-tooltip-prefer-bottom="true" tabindex="0">'+u((n.intlMessage||a&&a.intlMessage||r).call(i,{name:"intlMessage",hash:{intlName:null!=a?a.intlKey:a},data:s}))+"</li>\n"},2:function(e,a,n,l,s){return" first"},4:function(e,a,n,l,s){return" last"},6:function(e,a,n,l,s){return" selected"},8:function(e,a,n,l,s){var t;return' data-search-in-value="'+e.escapeExpression("function"==typeof(t=null!=(t=n.value||(null!=a?a.value:a))?t:n.helperMissing)?t.call(null!=a?a:{},{name:"value",hash:{},data:s}):t)+'"'},compiler:[7,">= 4.0.0"],main:function(e,a,n,l,s){var t,i=null!=a?a:{};return'<p class="option-header tabbable" tabindex="0">'+e.escapeExpression((n.intlMessage||a&&a.intlMessage||n.helperMissing).call(i,{name:"intlMessage",hash:{intlName:"search.SEARCH_IN"},data:s}))+'</p>\n<ul class="search-in-list">\n'+(null!=(t=n.each.call(i,null!=a?a.searchIns:a,{name:"each",hash:{},fn:e.program(1,s,0),inverse:e.noop,data:s}))?t:"")+"</ul>\n"},useData:!0}),l={};e.Array.each([],function(a){var n=e.Template.get("hermes/"+a);n&&(l[a]=n)}),e.Template.register("hermes/search-search-in-picker",function(a,s){return s=s||{},s.partials=s.partials?e.merge(l,s.partials):l,n(a,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("search-search-in-picker-view",function(e){var t=[{intlKey:"search.ALL",titleIntlKey:"search.FULL_TEXT",value:"text",selected:!0},{intlKey:"search.TAGS",titleIntlKey:"search.TAGS_ONLY",value:"tags"}];e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(s){var r,a,i=this;return this.searchUrl=s.searchUrl||new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),r=this.searchUrl.getAPIParam(e.SearchHelper.API.tags),this.searchIns=[],t.forEach(function(t){a=e.merge(t),(r||""===r)&&(a.selected="tags"===a.value),a.selected&&i.set("selectedSearchIn",a.value),i.searchIns.push(a)}),this.searchIns[0].isFirst=!0,this.searchIns[this.searchIns.length-1].isLast=!0,this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("search-search-in-picker",{searchIns:this.searchIns}),this},activate:function(){return this.registerEventHandler(this.get("container").delegate("click",this.handleSearchInClick.bind(this),".search-in-button")),this.registerEventHandler(this.get("container").delegate("key",this.handleSearchInClick.bind(this),"down:13",".search-in-button")),this},handleSearchInClick:function(t){var s=t.target.getData("search-in-value"),r=this.searchUrl.getSearchTerm();t.halt(),this.get("selectedSearchIn")!==s&&(this.set("selectedSearchIn",s),this.get("container").one(".search-in-button.selected").removeClass("selected"),t.target.addClass("selected"),this.searchUrl.removeAPIParam(e.SearchHelper.API.text),this.searchUrl.removeAPIParam(e.SearchHelper.API.tags),!this.get("selectedSearchIn")||this.isDefaultValue()?this.searchUrl.setAPIParam(e.SearchHelper.API.text,r):this.searchUrl.setAPIParam(e.SearchHelper.API.tags,r),this.fire("subviewViewEvent","search:urlUpdate",this.searchUrl))},isDefaultValue:function(){return"text"===this.get("selectedSearchIn")}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-search-in-picker"],langBundles:["search"]});YUI.add("hermes-template-search-date-picker",function(a,e){var t=a.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(a,e,t,n,s){var l,i=null!=e?e:{},d=t.helperMissing,r=a.escapeExpression;return'<div class="dropdown-link date-mode-menu tabbable" tabindex="-1"><p class="option-header">'+r("function"==typeof(l=null!=(l=t.dateMode||(null!=e?e.dateMode:e))?l:d)?l.call(i,{name:"dateMode",hash:{},data:s}):l)+'</p><span class="dropdown-arrow" aria-haspopup="true" aria-expanded="false"></span></div>\n<div class="date-inputs">\n  <div class="date-input-container">\n    <label>'+r((t.intlMessage||e&&e.intlMessage||d).call(i,{name:"intlMessage",hash:{intlName:"search.FROM"},data:s}))+'</label>\n    <input type="text" id="date-from" class="date-picker tabbable" placeholder="'+r((t.intlMessage||e&&e.intlMessage||d).call(i,{name:"intlMessage",hash:{intlName:"pika-day.DATE_FORMAT"},data:s}))+'" tabindex="0" />\n  </div>\n  <div class="date-input-container">\n    <label>'+r((t.intlMessage||e&&e.intlMessage||d).call(i,{name:"intlMessage",hash:{intlName:"search.TO"},data:s}))+'</label>\n    <input type="text" id="date-to" class="date-picker tabbable" placeholder="'+r((t.intlMessage||e&&e.intlMessage||d).call(i,{name:"intlMessage",hash:{intlName:"pika-day.DATE_FORMAT"},data:s}))+'" tabindex="0" />\n  </div>\n</div>\n'},useData:!0}),n={};a.Array.each([],function(e){var t=a.Template.get("hermes/"+e);t&&(n[e]=t)}),a.Template.register("hermes/search-date-picker",function(e,s){return s=s||{},s.partials=s.partials?a.merge(n,s.partials):n,t(e,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("search-date-picker-view",function(e){var t=[{intlKey:"search.DATE_TAKEN",value:"taken",isDefault:!0},{intlKey:"search.DATE_UPLOADED",value:"upload"}];e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(a){var i,s,n,l,r,h=this;return this.searchUrl=a.searchUrl||new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),i=this.searchUrl.getAPIParam(e.SearchHelper.API.minTakenDate),s=this.searchUrl.getAPIParam(e.SearchHelper.API.maxTakenDate),n=this.searchUrl.getAPIParam(e.SearchHelper.API.minUploadDate),l=this.searchUrl.getAPIParam(e.SearchHelper.API.maxUploadDate),this.closeOnScrollDistance=40,this.dateModes=[],t.forEach(function(t){r=e.merge(t,{text:h.intlMessage({intlName:t.intlKey})}),i||s?"taken"===r.value&&(h.set("selectedDateMode",r.value),h.set("selectedDateModeText",r.text)):n||l?"upload"===r.value&&(h.set("selectedDateMode",r.value),h.set("selectedDateModeText",r.text)):r.isDefault&&(h.set("selectedDateMode",r.value),h.set("selectedDateModeText",r.text)),h.dateModes.push(r)}),i||s?(this.set("selectedDateFrom",i),this.set("selectedDateTo",s)):(n||l)&&(this.set("selectedDateFrom",n),this.set("selectedDateTo",l)),this.dateIntl={previousMonth:this.intlMessage({intlName:"pika-day.PREVIOUS_MONTH"}),nextMonth:this.intlMessage({intlName:"pika-day.NEXT_MONTH"})},this.dateIntl.weekdays=[this.intlMessage({intlName:"pika-day.SUNDAY"}),this.intlMessage({intlName:"pika-day.MONDAY"}),this.intlMessage({intlName:"pika-day.TUESDAY"}),this.intlMessage({intlName:"pika-day.WEDNESDAY"}),this.intlMessage({intlName:"pika-day.THURSDAY"}),this.intlMessage({intlName:"pika-day.FRIDAY"}),this.intlMessage({intlName:"pika-day.SATURDAY"})],this.dateIntl.weekdaysShort=[this.intlMessage({intlName:"pika-day.SUNDAY_SHORT"}),this.intlMessage({intlName:"pika-day.MONDAY_SHORT"}),this.intlMessage({intlName:"pika-day.TUESDAY_SHORT"}),this.intlMessage({intlName:"pika-day.WEDNESDAY_SHORT"}),this.intlMessage({intlName:"pika-day.THURSDAY_SHORT"}),this.intlMessage({intlName:"pika-day.FRIDAY_SHORT"}),this.intlMessage({intlName:"pika-day.SATURDAY_SHORT"})],this.dateIntl.months=[this.intlMessage({intlName:"pika-day.JANUARY"}),this.intlMessage({intlName:"pika-day.FEBRUARY"}),this.intlMessage({intlName:"pika-day.MARCH"}),this.intlMessage({intlName:"pika-day.APRIL"}),this.intlMessage({intlName:"pika-day.MAY"}),this.intlMessage({intlName:"pika-day.JUNE"}),this.intlMessage({intlName:"pika-day.JULY"}),this.intlMessage({intlName:"pika-day.AUGUST"}),this.intlMessage({intlName:"pika-day.SEPTEMBER"}),this.intlMessage({intlName:"pika-day.OCTOBER"}),this.intlMessage({intlName:"pika-day.NOVEMBER"}),this.intlMessage({intlName:"pika-day.DECEMBER"})],this.basePikadayOptions={i18n:this.dateIntl,position:"bottom",reposition:!1,format:this.intlMessage({intlName:"pika-day.DATE_FORMAT"}),yearRange:[1826,(new Date).getFullYear()],onSelect:this.handleDateChange.bind(this),onOpen:function(){h.observePickerPageScroll(this)},onClose:function(){h.detachPickerPageScroll(this)}},this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("search-date-picker",{dateMode:this.get("selectedDateModeText")}),this},activate:function(){this.setupDatePickers();var e=this.get("container").one(".date-mode-menu");return this.registerEventHandler(e.on("click",this.handleDateModeMenuClick.bind(this))),this.registerEventHandler(e.on("key",this.handleDateModeMenuClick.bind(this),"down:13")),this.registerEventHandler(this.get("container").delegate("change",this.handleDateInputFieldChange.bind(this),".date-picker")),this},setupDatePickers:function(){var t=this.get("selectedDateFrom"),a=this.get("selectedDateTo");this.datePickers={},this.datePickers.from=new e.Pikaday(e.merge(this.basePikadayOptions,{field:this.get("container").one("#date-from.date-picker").getDOMNode(),defaultDate:t?new Date(1e3*parseInt(t)):null,setDefaultDate:!!t})),this.datePickers.to=new e.Pikaday(e.merge(this.basePikadayOptions,{field:this.get("container").one("#date-to.date-picker").getDOMNode(),defaultDate:a?new Date(1e3*parseInt(a)):null,setDefaultDate:!!a}))},handleDateModeMenuClick:function(t){var a=this;t.halt(),this.dropdown=new e.Views.FluidDroparound({appContext:this.appContext,showDropArrow:!0,observePageResize:!0,anchorElement:this.get("container").one(".dropdown-arrow"),keyboardAnchorElement:this.get("container").one(".dropdown-link"),positionFixed:!0,closeOnScroll:!0,preferLeft:!0,anchorOffsetHorizontal:16,menuItems:this.dateModes}),this.dropdown.show(),this.registerEventHandler(this.dropdown.on("selected",function(e){e&&e.menuItem&&e.menuItem.value!==a.get("selectedDateMode")&&(a.set("selectedDateMode",e.menuItem.value),a.set("selectedDateModeText",e.menuItem.text),a.get("container").one(".date-mode-menu p").set("text",a.get("selectedDateModeText")),a.isDefaultValue()||a.processUpdate()),a.dropdown.close()}))},handleDateInputFieldChange:function(e){e.halt(),e.target.get("value")||this.handleDateChange()},handleDateChange:function(){var e,t=this.datePickers.from.toString("X");this.datePickers.to.getDate()&&(e=this.datePickers.to.getMoment().add({hours:23,minutes:59,seconds:59}).format("X")),t===this.get("selectedDateFrom")&&e===this.get("selectedDateTo")||(this.set("selectedDateFrom",t),this.set("selectedDateTo",e),this.processUpdate())},processUpdate:function(){var t=this.get("selectedDateMode"),a=this.get("selectedDateFrom"),i=this.get("selectedDateTo"),s="upload"===t?e.SearchHelper.API.minUploadDate:e.SearchHelper.API.minTakenDate,n="upload"===t?e.SearchHelper.API.maxUploadDate:e.SearchHelper.API.maxTakenDate;this.searchUrl.removeAPIParam(e.SearchHelper.API.minTakenDate),this.searchUrl.removeAPIParam(e.SearchHelper.API.maxTakenDate),this.searchUrl.removeAPIParam(e.SearchHelper.API.minUploadDate),this.searchUrl.removeAPIParam(e.SearchHelper.API.maxUploadDate),this.isDefaultValue()||(a&&this.searchUrl.setAPIParam(s,a),i&&this.searchUrl.setAPIParam(n,i)),this.fire("subviewViewEvent","search:urlUpdate",this.searchUrl)},isDefaultValue:function(){return!(this.get("selectedDateFrom")||this.get("selectedDateTo"))},observePickerPageScroll:function(t){var a=YUI.Env.isServer?0:e.config.win.pageYOffset,i=this;this.set("startingScrollPoint",a),t&&(t.handlerID=this.registerEventHandler(e.globalEvents.subscribe("window:scroll",function(e){i.handleScroll.call(i,e,t)})))},detachPickerPageScroll:function(e){var t;e&&(t=e.handlerID)&&this.detachRegisteredEvent(t)},handleScroll:function(t,a){var i,s=this.get("startingScrollPoint");s?(i=e.config.win.pageYOffset,(s+this.closeOnScrollDistance<i||s-this.closeOnScrollDistance>i)&&a.hide()):this.set("startingScrollPoint",e.config.win.pageYOffset)}})},"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-droparound-view","hermes-template-search-date-picker","search-helper","search-url"],langBundles:["search","pika-day"]});YUI.add("hermes-lang-pika-day",function(A,S){A.Intl.add("hermes/pika-day","en-US",{DATE_FORMAT:["MM-DD-YYYY"],PREVIOUS_MONTH:["Previous Month"],NEXT_MONTH:["Next Month"],JANUARY:["January"],FEBRUARY:["February"],MARCH:["March"],APRIL:["April"],MAY:["May"],JUNE:["June"],JULY:["July"],AUGUST:["August"],SEPTEMBER:["September"],OCTOBER:["October"],NOVEMBER:["November"],DECEMBER:["December"],SUNDAY:["Sunday"],MONDAY:["Monday"],TUESDAY:["Tuesday"],WEDNESDAY:["Wednesday"],THURSDAY:["Thursday"],FRIDAY:["Friday"],SATURDAY:["Saturday"],SUNDAY_SHORT:["S"],MONDAY_SHORT:["M"],TUESDAY_SHORT:["T"],WEDNESDAY_SHORT:["W"],THURSDAY_SHORT:["T"],FRIDAY_SHORT:["F"],SATURDAY_SHORT:["S"]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-template-search-slender-advanced-panel",function(t,a){var e=t.Template.Handlebars.revive({1:function(t,a,e,l,n){var s,i=null!=a?a:{},u=e.helperMissing,o=t.escapeExpression;return'\t<div class="advanced-panel">\n\n\t\t<div class="fluid-centered">\n\t\t\t<div class="quick-filter">\n\n\t\t\t\t'+o((e.outlet||a&&a.outlet||u).call(i,null!=a?a["search-color-picker-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\n\t\t\t\t"+o((e.outlet||a&&a.outlet||u).call(i,null!=a?a["search-style-picker-view"]:a,{name:"outlet",hash:{},data:n}))+'\n\n\t\t\t\t<div class="advanced-toggle">\n\t\t\t\t\t<a class=\'tertiary\' title="'+o((e.intlHTMLMessage||a&&a.intlHTMLMessage||u).call(i,{name:"intlHTMLMessage",hash:{intlName:"search.TOGGLE_ADVANCED"},data:n}))+'" href="#" data-track="search-toggle-advanced" aria-haspopup="true" aria-expanded="false">'+o((e.intlHTMLMessage||a&&a.intlHTMLMessage||u).call(i,{name:"intlHTMLMessage",hash:{intlName:"search.ADVANCED"},data:n}))+'<span class="advanced-icon'+(null!=(s=e.if.call(i,null!=a?a.collapseAdvancedOptions:a,{name:"if",hash:{},fn:t.program(2,n,0),inverse:t.noop,data:n}))?s:"")+'"></span></a>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="advanced-options fluid-centered'+(null!=(s=e.if.call(i,null!=a?a.collapseAdvancedOptions:a,{name:"if",hash:{},fn:t.program(2,n,0),inverse:t.noop,data:n}))?s:"")+'">\n\n\t\t\t'+o((e.outlet||a&&a.outlet||u).call(i,null!=a?a["search-orientation-picker-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\n\t\t\t"+o((e.outlet||a&&a.outlet||u).call(i,null!=a?a["search-min-size-picker-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\n\t\t\t"+o((e.outlet||a&&a.outlet||u).call(i,null!=a?a["search-date-picker-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\n\t\t\t"+o((e.outlet||a&&a.outlet||u).call(i,null!=a?a["search-content-picker-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\n\t\t\t"+o((e.outlet||a&&a.outlet||u).call(i,null!=a?a["search-search-in-picker-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\n\t\t</div>\n\n\t</div>\n"},2:function(t,a,e,l,n){return" collapsed"},4:function(t,a,e,l,n){var s,i=null!=a?a:{};return'\t\t\t<div class="inactive-groups-toggle">\n\t\t\t\t<input id="inactive-groups-toggle-checkbox" type="checkbox"'+(null!=(s=e.if.call(i,null!=a?a.isInactiveGroupsToggleChecked:a,{name:"if",hash:{},fn:t.program(5,n,0),inverse:t.noop,data:n}))?s:"")+' />\n\t\t\t\t<label for="inactive-groups-toggle-checkbox">'+t.escapeExpression((e.intlHTMLMessage||a&&a.intlHTMLMessage||e.helperMissing).call(i,{name:"intlHTMLMessage",hash:{intlName:"search.HIDE_INACTIVE_GROUPS"},data:n}))+"</label>\n\t\t\t</div>\n"},5:function(t,a,e,l,n){return" checked"},7:function(t,a,e,l,n){return"\t\t\t"+t.escapeExpression((e.outlet||a&&a.outlet||e.helperMissing).call(null!=a?a:{},null!=a?a["search-sort-menu-view"]:a,{name:"outlet",hash:{},data:n}))+"\n"},9:function(t,a,e,l,n){var s;return'\t\t\t<div class="layout-toggles">\n'+(null!=(s=e.if.call(null!=a?a:{},null!=a?a.showTilesButton:a,{name:"if",hash:{},fn:t.program(10,n,0),inverse:t.program(13,n,0),data:n}))?s:"")+"\t\t\t</div>\n"},10:function(t,a,e,l,n){var s,i,u=null!=a?a:{},o=e.helperMissing,r=t.escapeExpression;return'\t\t\t\t\t<button data-layout-style="'+r("function"==typeof(i=null!=(i=e.thumbsLayoutButtonData||(null!=a?a.thumbsLayoutButtonData:a))?i:o)?i.call(u,{name:"thumbsLayoutButtonData",hash:{},data:n}):i)+'" class="layout thumbs'+(null!=(s=e.if.call(u,null!=a?a.isThumbsLayout:a,{name:"if",hash:{},fn:t.program(11,n,0),inverse:t.noop,data:n}))?s:"")+'" data-track="search-layout-thumbs" title="'+r((e.intlHTMLMessage||a&&a.intlHTMLMessage||o).call(u,{name:"intlHTMLMessage",hash:{intlName:"search.THUMBNAIL_VIEW"},data:n}))+'"></button>\n\t\t\t\t\t<button data-layout-style="'+r("function"==typeof(i=null!=(i=e.justifiedLayoutButtonData||(null!=a?a.justifiedLayoutButtonData:a))?i:o)?i.call(u,{name:"justifiedLayoutButtonData",hash:{},data:n}):i)+'" class="layout justified'+(null!=(s=e.if.call(u,null!=a?a.isJustifiedLayout:a,{name:"if",hash:{},fn:t.program(11,n,0),inverse:t.noop,data:n}))?s:"")+'" data-track="search-layout-justified" title="'+r((e.intlHTMLMessage||a&&a.intlHTMLMessage||o).call(u,{name:"intlHTMLMessage",hash:{intlName:"search.JUSTIFIED_VIEW"},data:n}))+'"></button>\n\t\t\t\t\t<button data-layout-style="'+r("function"==typeof(i=null!=(i=e.tilesLayoutButtonData||(null!=a?a.tilesLayoutButtonData:a))?i:o)?i.call(u,{name:"tilesLayoutButtonData",hash:{},data:n}):i)+'" class="layout tiles'+(null!=(s=e.if.call(u,null!=a?a.isTilesLayout:a,{name:"if",hash:{},fn:t.program(11,n,0),inverse:t.noop,data:n}))?s:"")+'" data-track="search-layout-tiles" title="'+r((e.intlHTMLMessage||a&&a.intlHTMLMessage||o).call(u,{name:"intlHTMLMessage",hash:{intlName:"search.TILE_VIEW"},data:n}))+'"></button>\n'},11:function(t,a,e,l,n){return" selected"},13:function(t,a,e,l,n){var s,i,u=null!=a?a:{},o=e.helperMissing,r=t.escapeExpression;return'\t\t\t\t\t<button data-layout-style="'+r("function"==typeof(i=null!=(i=e.justifiedLayoutButtonData||(null!=a?a.justifiedLayoutButtonData:a))?i:o)?i.call(u,{name:"justifiedLayoutButtonData",hash:{},data:n}):i)+'" class="layout justified'+(null!=(s=e.if.call(u,null!=a?a.isJustifiedLayout:a,{name:"if",hash:{},fn:t.program(11,n,0),inverse:t.noop,data:n}))?s:"")+'" data-track="search-layout-justified" title="'+r((e.intlHTMLMessage||a&&a.intlHTMLMessage||o).call(u,{name:"intlHTMLMessage",hash:{intlName:"search.JUSTIFIED_VIEW"},data:n}))+'"></button>\n\t\t\t\t\t<button data-layout-style="'+r("function"==typeof(i=null!=(i=e.thumbsLayoutButtonData||(null!=a?a.thumbsLayoutButtonData:a))?i:o)?i.call(u,{name:"thumbsLayoutButtonData",hash:{},data:n}):i)+'" class="layout thumbs'+(null!=(s=e.if.call(u,null!=a?a.isThumbsLayout:a,{name:"if",hash:{},fn:t.program(11,n,0),inverse:t.noop,data:n}))?s:"")+'" data-track="search-layout-thumbs" title="'+r((e.intlHTMLMessage||a&&a.intlHTMLMessage||o).call(u,{name:"intlHTMLMessage",hash:{intlName:"search.THUMBNAIL_VIEW"},data:n}))+'"></button>\n'},15:function(t,a,e,l,n){return'\t\t<div class="filters">\n\t\t\t'+t.escapeExpression((e.outlet||a&&a.outlet||e.helperMissing).call(null!=a?a:{},null!=a?a["search-filter-tools-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\t\t</div>\n"},compiler:[7,">= 4.0.0"],main:function(t,a,e,l,n){var s,i=null!=a?a:{};return(null!=(s=e.unless.call(i,null!=a?a.showToolbarOnly:a,{name:"unless",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n}))?s:"")+'\n<div class="tool-bar fluid-centered">\n\n\t<div class="tools">\n'+(null!=(s=e.if.call(i,null!=a?a.showInactiveGroupsToggle:a,{name:"if",hash:{},fn:t.program(4,n,0),inverse:t.noop,data:n}))?s:"")+"\n\t\t"+t.escapeExpression((e.outlet||a&&a.outlet||e.helperMissing).call(i,null!=a?a["search-camera-settings-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\n"+(null!=(s=e.if.call(i,null!=a?a.showSortMenu:a,{name:"if",hash:{},fn:t.program(7,n,0),inverse:t.noop,data:n}))?s:"")+"\n"+(null!=(s=e.if.call(i,null!=a?a.showLayoutToggles:a,{name:"if",hash:{},fn:t.program(9,n,0),inverse:t.noop,data:n}))?s:"")+"\t</div>\n\n"+(null!=(s=e.if.call(i,null!=a?a.showFilterMenus:a,{name:"if",hash:{},fn:t.program(15,n,0),inverse:t.noop,data:n}))?s:"")+"</div>\n"},useData:!0}),l={};t.Array.each([],function(a){var e=t.Template.get("hermes/"+a);e&&(l[a]=e)}),t.Template.register("hermes/search-slender-advanced-panel",function(a,n){return n=n||{},n.partials=n.partials?t.merge(l,n.partials):l,e(a,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("search-slender-advanced-panel-view",function(e){var t="search-advanced-panel-state";e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var i=t.modelParams&&t.modelParams.apiParams?e.merge(t.modelParams.apiParams):{};return""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.searchUrl=new e.SearchUrl(i,this.appContext,t.searchType),t.searchUrl=this.searchUrl,this.set("areAdvancedOptionsVisible",this.getStoredAdvancedOptionsState()||t.openAdvanced),this.set("showToolbarOnly",t.showToolbarOnly),this.set("showFilterMenus",t.showTools),this.set("showInactiveGroupToggle",t.showInactiveToggle),this.set("showSortMenu",t.showSort),this.set("showLayoutToggles",t.showTools),this.set("showInactiveGroupsToggle",t.showInactiveToggle),this.set("isInactiveGroupsToggleChecked","0"!==this.searchUrl.getAPIParam(e.SearchHelper.GROUPS_SEARCH_API.filterInactive)),this.set("layoutStyle",t.viewType||e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.justified),this},subviewConfig:{"search-filter-tools-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-sort-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-color-picker-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"search-style-picker-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"search-orientation-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-min-size-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-date-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-search-in-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-content-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-camera-settings-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,disabled:function(){return!this.appContext.flipper.isFlipped("enable-exposure-search")}}},loadState:function(){var t=this,i=[];return this.appContext.getViewer().signedIn&&i.push(this.appContext.getModel("person-preferences-models",this.appContext.getViewer().nsid).then(function(e){t.set("viewerPrefsModel",e)})),e.Promise.all(i)},buildContainer:function(){return this.setContainerWithTemplate("search-slender-advanced-panel",{collapseAdvancedOptions:!this.get("areAdvancedOptionsVisible"),showToolbarOnly:this.get("showToolbarOnly"),showFilterMenus:this.get("showFilterMenus"),showInactiveGroupToggle:this.get("showInactiveGroupToggle"),showSortMenu:this.get("showSortMenu"),showLayoutToggles:this.get("showLayoutToggles"),showInactiveGroupsToggle:this.get("showInactiveGroupsToggle"),showTilesButton:this.appContext.flipper.isFlipped("search-tiles"),isInactiveGroupsToggleChecked:this.get("isInactiveGroupsToggleChecked"),justifiedLayoutButtonData:e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.justified,thumbsLayoutButtonData:e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.thumbs,tilesLayoutButtonData:e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.tiles,isJustifiedLayout:this.get("layoutStyle")===e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.justified,isThumbsLayout:this.get("layoutStyle")===e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.thumbs,isTilesLayout:this.get("layoutStyle")===e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.tiles}),this},activate:function(){var e=this.get("container");return this.get("showToolbarOnly")||this.registerEventHandler(e.one(".advanced-toggle").on("click",this.handleAdvancedToggleClick.bind(this))),this.get("showLayoutToggles")&&this.registerEventHandler(e.delegate("click",this.handleLayoutToggleClick.bind(this),".layout")),this.get("showInactiveGroupsToggle")&&this.registerEventHandler(e.one("#inactive-groups-toggle-checkbox").on("change",this.handleInactiveGroupsToggleChange.bind(this))),this.registerEventHandler(e.delegate("mouseenter",this.handleTooltipElemMouseEnter.bind(this),"[data-tooltip-title]")),this.registerEventHandler(e.delegate("mouseleave",this.handleTooltipElemMouseLeave.bind(this),"[data-tooltip-title]")),e.setAttribute("role","toolbar"),this.setupAccessibilityAttributes(),this},setupAccessibilityAttributes:function(){var e=this.get("container"),t=e.all(".tabbable"),i=e.one(".advanced-toggle .tertiary");this.get("areAdvancedOptionsVisible")?(t.setAttribute("tabindex","0"),t.setAttribute("aria-hidden","false"),i&&i.setAttribute("aria-expanded","true")):(t.setAttribute("tabindex","-1"),t.setAttribute("aria-hidden","true"),i&&i.setAttribute("aria-expanded","false"))},onSubviewEvent:function(e,t){var i=t&&t.length&&t[0];switch(i){case"search:urlUpdate":t[1]&&(this.searchUrl=t[1],this.fire("subviewViewEvent","search:dirty"),this.appContext.flapp.navigate(this.searchUrl.getURL()));break;case"search:blackandwhiteStyleSelected":case"search:colorSelected":this.fire("parentViewEvent",i)}},handleLayoutToggleClick:function(e){var t,i,s=this.get("container");e.preventDefault(),(t=e.target.getData("layout-style"))!==this.get("layoutStyle")&&((i=s.one(".layout.selected"))&&i.removeClass("selected"),e.target.addClass("selected"),this.set("layoutStyle",t),this.get("viewerPrefsModel")&&(this.get("viewerPrefsModel").setValue("unifiedSearchViewPref",this.get("layoutStyle")),this.get("viewerPrefsModel").remoteUpdate()),this.fire("subviewViewEvent","search:layoutChange",this.get("layoutStyle")))},handleAdvancedToggleClick:function(t){var i=this.get("container"),s=i.one(".advanced-options"),r=this;t.preventDefault(),i.one(".advanced-icon").toggleClass("collapsed"),s.toggleClass("collapsed"),this.set("areAdvancedOptionsVisible",!this.get("areAdvancedOptionsVisible")),this.storeAdvancedOptionsState(this.get("areAdvancedOptionsVisible")),this.setupAccessibilityAttributes(),this.fire("subviewViewEvent","search:startAdvancedPanelTransition",this.get("areAdvancedOptionsVisible")),e.flutil.onTransitionEnd(s,function(){r.fire("subviewViewEvent","search:finishAdvancedPanelTransition",r.get("areAdvancedOptionsVisible"))})},handleInactiveGroupsToggleChange:function(t){t.halt(),t.target.get("checked")?this.searchUrl.removeAPIParam(e.SearchHelper.GROUPS_SEARCH_API.filterInactive):this.searchUrl.setAPIParam(e.SearchHelper.GROUPS_SEARCH_API.filterInactive,"0"),this.appContext.flapp.navigate(this.searchUrl.getURL())},handleTooltipElemMouseEnter:function(t){var i=t.target.getData("tooltip-title"),s=this;t.halt(),this.tooltipDroparound&&this.tooltipDroparound.close(),clearTimeout(this.tooltipHoverTimer),this.isHovering=!0,this.tooltipHoverTimer=setTimeout(function(){s.isHovering&&(s.tooltipDroparound=new e.Views.FluidDroparound({appContext:s.appContext,showDropArrow:!0,dismissOnOverlayClick:!1,dismissOnActionClick:!1,observePageResize:!0,anchorElement:t.target,positionFixed:!0,closeOnScroll:!0,hideModalOverlay:!0,invisibleOverlay:!0,autoSizeToContent:!0,useAnchorOffsetSize:!0,horizCenterToAnchor:!0,preferBottom:t.target.getData("tooltip-prefer-bottom"),classList:"advanced-panel-tooltip",textMessage:i}),s.tooltipDroparound.show())},300)},handleTooltipElemMouseLeave:function(e){e.halt(),this.isHovering=!1,this.tooltipDroparound&&this.tooltipDroparound.close()},getStoredAdvancedOptionsState:function(){var i;return YUI.Env.isServer||(e.SearchUrl.isSearchUrl(this.appContext.getPreviousURL())?i=e.AttributeHelpers.coerceBoolean(e.StorageHelper.getItem(t,!0)):e.StorageHelper.remove(t,!0)),i||!1},storeAdvancedOptionsState:function(i){YUI.Env.isServer||e.StorageHelper.setItem(t,i,!0)},beforeDestroy:function(){this.detachRegisteredEvents(),clearTimeout(this.tooltipHoverTimer),this.isHovering=!1,this.tooltipDroparound&&this.tooltipDroparound.close()}})},"@VERSION@",{requires:["flickr-view","flickr-promise","search-filter-tools-view","search-sort-menu-view","search-color-picker-view","search-style-picker-view","search-orientation-picker-view","search-min-size-picker-view","search-content-picker-view","search-search-in-picker-view","search-date-picker-view","hermes-template-search-slender-advanced-panel","attribute-helpers","storage-helper","flutil","person-preferences-models"],optionalRequires:["pika-day"],langBundles:["search","pika-day","common"]});YUI.add("pika-day",function(t,e){"undefined"!=typeof window&&(this.moment=window.moment),/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */
(function(t,e){"use strict";var n;if("object"==typeof exports){try{n=require("moment")}catch(t){}module.exports=e(n)}else"function"==typeof define&&define.amd?define(function(t){try{n=t("moment")}catch(t){}return e(n)}):t.Pikaday=e(t.moment)})(this,function(t){"use strict";var e="function"==typeof t,n=!!window.addEventListener,i=window.document,a=window.setTimeout,o=function(t,e,i,a){n?t.addEventListener(e,i,!!a):t.attachEvent("on"+e,i)},s=function(t,e,i,a){n?t.removeEventListener(e,i,!!a):t.detachEvent("on"+e,i)},r=function(t,e,n){var a;i.createEvent?((a=i.createEvent("HTMLEvents")).initEvent(e,!0,!1),a=m(a,n),t.dispatchEvent(a)):i.createEventObject&&(a=i.createEventObject(),a=m(a,n),t.fireEvent("on"+e,a))},l=function(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")},h=function(t){return/Array/.test(Object.prototype.toString.call(t))},d=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},u=function(t){var e=t.getDay();return 0===e||6===e},f=function(t){d(t)&&t.setHours(0,0,0,0)},c=function(t,e){return t.getTime()===e.getTime()},m=function(t,e,n){var i,a;for(i in e)(a=void 0!==t[i])&&"object"==typeof e[i]&&null!==e[i]&&void 0===e[i].nodeName?d(e[i])?n&&(t[i]=new Date(e[i].getTime())):h(e[i])?n&&(t[i]=e[i].slice(0)):t[i]=m({},e[i],n):!n&&a||(t[i]=e[i]);return t},p=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},g={field:null,bound:void 0,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},onSelect:null,onOpen:null,onClose:null,onDraw:null},y=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},D=function(t,e,n,i,a,o,s){if(s)return'<td class="is-empty"></td>';var r=[];return o&&r.push("is-disabled"),a&&r.push("is-today"),i&&r.push("is-selected"),'<td data-day="'+t+'" class="'+r.join(" ")+'"><button class="pika-button pika-day" type="button" data-pika-year="'+n+'" data-pika-month="'+e+'" data-pika-day="'+t+'">'+t+"</button></td>"},v=function(t,e,n){var i=new Date(n,0,1);return'<td class="pika-week">'+Math.ceil(((new Date(n,e,t)-i)/864e5+i.getDay()+1)/7)+"</td>"},_=function(t,e){return"<tr>"+(e?t.reverse():t).join("")+"</tr>"},b=function(t,e,n,i,a){var o,s,r,l,d,u=t._o,f=n===u.minYear,c=n===u.maxYear,m='<div class="pika-title">',p=!0,g=!0;for(r=[],o=0;o<12;o++)r.push('<option value="'+(n===a?o-e:12+o-e)+'"'+(o===i?" selected":"")+(f&&o<u.minMonth||c&&o>u.maxMonth?"disabled":"")+">"+u.i18n.months[o]+"</option>");for(l='<div class="pika-label">'+u.i18n.months[i]+'<select class="pika-select pika-select-month">'+r.join("")+"</select></div>",h(u.yearRange)?(o=u.yearRange[0],s=u.yearRange[1]+1):(o=n-u.yearRange,s=1+n+u.yearRange),r=[];o<s&&o<=u.maxYear;o++)o>=u.minYear&&r.push('<option value="'+o+'"'+(o===n?" selected":"")+">"+o+"</option>");return d='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year">'+r.join("")+"</select></div>",u.showMonthAfterYear?m+=d+l:m+=l+d,f&&(0===i||u.minMonth>=i)&&(p=!1),c&&(11===i||u.maxMonth<=i)&&(g=!1),0===e&&(m+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(m+='<button class="pika-next'+(g?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),m+="</div>"},w=function(t,e){return'<table cellpadding="0" cellspacing="0" class="pika-table">'+(function(t){var e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+y(t,e)+'">'+y(t,e,!0)+"</abbr></th>");return"<thead>"+(t.isRTL?n.reverse():n).join("")+"</thead>"})(t)+(function(t){return"<tbody>"+t.join("")+"</tbody>"})(e)+"</table>"},M=function(s){var r=this,h=r.config(s);r._onMouseDown=function(t){if(r._v){var e=(t=t||window.event).target||t.srcElement;if(e){if(!l(e,"is-disabled")){if(l(e,"pika-button")&&!l(e,"is-empty"))return r.setDate(new Date(e.getAttribute("data-pika-year"),e.getAttribute("data-pika-month"),e.getAttribute("data-pika-day"))),void(h.bound&&a(function(){r.hide(),h.field&&h.field.blur()},100));l(e,"pika-prev")?r.prevMonth():l(e,"pika-next")&&r.nextMonth()}if(l(e,"pika-select"))r._c=!0;else{if(!t.preventDefault)return t.returnValue=!1,!1;t.preventDefault()}}}},r._onChange=function(t){var e=(t=t||window.event).target||t.srcElement;e&&(l(e,"pika-select-month")?r.gotoMonth(e.value):l(e,"pika-select-year")&&r.gotoYear(e.value))},r._onInputChange=function(n){var i;n.firedBy!==r&&(i=e?(i=t(h.field.value,h.format))&&i.isValid()?i.toDate():null:new Date(Date.parse(h.field.value)),r.setDate(d(i)?i:null),r._v||r.show())},r._onInputFocus=function(){r.show()},r._onInputClick=function(){r.show()},r._onInputBlur=function(){var t=i.activeElement;do{if(l(t,"pika-single"))return}while(t=t.parentNode);r._c||(r._b=a(function(){r.hide()},50)),r._c=!1},r._onClick=function(t){var e=(t=t||window.event).target||t.srcElement,i=e;if(e){!n&&l(e,"pika-select")&&(e.onchange||(e.setAttribute("onchange","return;"),o(e,"change",r._onChange)));do{if(l(i,"pika-single")||i===h.trigger)return}while(i=i.parentNode);r._v&&e!==h.trigger&&i!==h.trigger&&r.hide()}},r.el=i.createElement("div"),r.el.className="pika-single"+(h.isRTL?" is-rtl":""),o(r.el,"mousedown",r._onMouseDown,!0),o(r.el,"change",r._onChange),h.field&&(h.container?h.container.appendChild(r.el):h.bound?i.body.appendChild(r.el):h.field.parentNode.insertBefore(r.el,h.field.nextSibling),o(h.field,"change",r._onInputChange),h.defaultDate||(e&&h.field.value?h.defaultDate=t(h.field.value,h.format).toDate():h.defaultDate=new Date(Date.parse(h.field.value)),h.setDefaultDate=!0));var u=h.defaultDate;d(u)?h.setDefaultDate?r.setDate(u,!0):r.gotoDate(u):r.gotoDate(new Date),h.bound?(this.hide(),r.el.className+=" is-bound",o(h.trigger,"click",r._onInputClick),o(h.trigger,"focus",r._onInputFocus),o(h.trigger,"blur",r._onInputBlur)):this.show()};return M.prototype={config:function(t){this._o||(this._o=m({},g,!0));var e=m(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null;var n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,d(e.minDate)||(e.minDate=!1),d(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&(f(e.minDate),e.minYear=e.minDate.getFullYear(),e.minMonth=e.minDate.getMonth()),e.maxDate&&(f(e.maxDate),e.maxYear=e.maxDate.getFullYear(),e.maxMonth=e.maxDate.getMonth()),h(e.yearRange)){var i=(new Date).getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||g.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(n){return d(this._d)?e?t(this._d).format(n||this._o.format):this._d.toDateString():""},getMoment:function(){return e?t(this._d):null},setMoment:function(n,i){e&&t.isMoment(n)&&this.setDate(n.toDate(),i)},getDate:function(){return d(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",r(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof t&&(t=new Date(Date.parse(t))),d(t)){var n=this._o.minDate,i=this._o.maxDate;d(n)&&t<n?t=n:d(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),f(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),r(this._o.field,"change",{firedBy:this})),e||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(t){var e=!0;if(d(t)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),a=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=a<n.getTime()||i.getTime()<a}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustCalendars:function(){this.calendars[0]=p(this.calendars[0]);for(var t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=p({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){this._o.minDate=t},setMaxDate:function(t){this._o.maxDate=t},draw:function(t){if(this._v||t){var e=this._o,n=e.minYear,i=e.maxYear,o=e.minMonth,s=e.maxMonth,r="";this._y<=n&&(this._y=n,!isNaN(o)&&this._m<o&&(this._m=o)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s));for(var l=0;l<e.numberOfMonths;l++)r+='<div class="pika-lendar">'+b(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year)+this.render(this.calendars[l].year,this.calendars[l].month)+"</div>";if(this.el.innerHTML=r,e.bound&&"hidden"!==e.field.type&&a(function(){e.trigger.focus()},1),"function"==typeof this._o.onDraw){var h=this;a(function(){h._o.onDraw.call(h)},0)}}},adjustPosition:function(){if(!this._o.container){var t,e,n,a=this._o.trigger,o=a,s=this.el.offsetWidth,r=this.el.offsetHeight,l=window.innerWidth||i.documentElement.clientWidth,h=window.innerHeight||i.documentElement.clientHeight,d=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop;if("function"==typeof a.getBoundingClientRect)t=(n=a.getBoundingClientRect()).left+window.pageXOffset,e=n.bottom+window.pageYOffset;else for(t=o.offsetLeft,e=o.offsetTop+o.offsetHeight;o=o.offsetParent;)t+=o.offsetLeft,e+=o.offsetTop;(this._o.reposition&&t+s>l||this._o.position.indexOf("right")>-1&&t-s+a.offsetWidth>0)&&(t=t-s+a.offsetWidth),(this._o.reposition&&e+r>h+d||this._o.position.indexOf("top")>-1&&e-r-a.offsetHeight>0)&&(e=e-r-a.offsetHeight),this.el.style.cssText=["position: absolute","left: "+t+"px","top: "+e+"px"].join(";")}},render:function(t,e){var n=this._o,i=new Date,a=(function(t,e){return[31,(function(t){return t%4==0&&t%100!=0||t%400==0})(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]})(t,e),o=new Date(t,e,1).getDay(),s=[],r=[];f(i),n.firstDay>0&&(o-=n.firstDay)<0&&(o+=7);for(var l=a+o,h=l;h>7;)h-=7;l+=7-h;for(var m=0,p=0;m<l;m++){var g=new Date(t,e,m-o+1),y=!!d(this._d)&&c(g,this._d),b=c(g,i),M=m<o||m>=a+o,k=n.minDate&&g<n.minDate||n.maxDate&&g>n.maxDate||n.disableWeekends&&u(g)||n.disableDayFn&&n.disableDayFn(g);r.push(D(m-o+1,e,t,y,b,k,M)),7==++p&&(n.showWeekNumber&&r.unshift(v(m-o,e,t)),s.push(_(r,n.isRTL)),r=[],p=0)}return w(n,s)},isVisible:function(){return this._v},show:function(){this._v||(!(function(t,e){t.className=(function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")})((" "+t.className+" ").replace(" "+e+" "," "))})(this.el,"is-hidden"),this._v=!0,this.draw(),this._o.bound&&(o(i,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var t=this._v;!1!==t&&(this._o.bound&&s(i,"click",this._onClick),this.el.style.cssText="",(function(t,e){l(t,e)||(t.className=""===t.className?e:t.className+" "+e)})(this.el,"is-hidden"),this._v=!1,void 0!==t&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"change",this._onChange),this._o.field&&(s(this._o.field,"change",this._onInputChange),this._o.bound&&(s(this._o.trigger,"click",this._onInputClick),s(this._o.trigger,"focus",this._onInputFocus),s(this._o.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},M}),t.Pikaday=this.Pikaday},"@VERSION@",{affinity:"client"});YUI.add("hermes-template-search-photos-everyone-view",function(n,l){var e=n.Template.Handlebars.revive({1:function(n,l,e,a,s){var t;return null!=(t=e.if.call(null!=l?l:{},null!=l?l.viewAll:l,{name:"if",hash:{},fn:n.program(2,s,0),inverse:n.program(7,s,0),data:s}))?t:""},2:function(n,l,e,a,s){var t,i,r=null!=l?l:{};return'\t\t<div>\n\t\t\t<h5 class="search-results-header">'+(null!=(t=e.unless.call(r,null!=l?l.loading:l,{name:"unless",hash:{},fn:n.program(3,s,0),inverse:n.noop,data:s}))?t:"")+n.escapeExpression("function"==typeof(i=null!=(i=e.photoListTitle||(null!=l?l.photoListTitle:l))?i:e.helperMissing)?i.call(r,{name:"photoListTitle",hash:{},data:s}):i)+(null!=(t=e.if.call(r,null!=l?l.loading:l,{name:"if",hash:{},fn:n.program(5,s,0),inverse:n.noop,data:s}))?t:"")+"</h5>\n\t\t</div>\n"},3:function(n,l,e,a,s){return'<span class="secondary">'+n.escapeExpression((e.intlHTMLMessage||l&&l.intlHTMLMessage||e.helperMissing).call(null!=l?l:{},{name:"intlHTMLMessage",hash:{count:null!=l?l.photoCount:l,intlName:"search.RESULTS_COUNT"},data:s}))+"</span>"},5:function(n,l,e,a,s){return' <div class="flickr-dots inline"></div>'},7:function(n,l,e,a,s){var t,i,r=null!=l?l:{};return'\t\t<div>\n\t\t\t<h5 class="search-results-header">'+(null!=(t=e.unless.call(r,null!=l?l.loading:l,{name:"unless",hash:{},fn:n.program(8,s,0),inverse:n.noop,data:s}))?t:"")+n.escapeExpression("function"==typeof(i=null!=(i=e.photoListTitle||(null!=l?l.photoListTitle:l))?i:e.helperMissing)?i.call(r,{name:"photoListTitle",hash:{},data:s}):i)+(null!=(t=e.if.call(r,null!=l?l.loading:l,{name:"if",hash:{},fn:n.program(5,s,0),inverse:n.noop,data:s}))?t:"")+"</h5>\n\t\t</div>\n"},8:function(n,l,e,a,s){var t;return null!=(t=e.unless.call(null!=l?l:{},null!=l?l.singleResult:l,{name:"unless",hash:{},fn:n.program(9,s,0),inverse:n.noop,data:s}))?t:""},9:function(n,l,e,a,s){var t,i=null!=l?l:{},r=e.helperMissing,o=n.escapeExpression;return'<a href="'+o("function"==typeof(t=null!=(t=e.viewAllLink||(null!=l?l.viewAllLink:l))?t:r)?t.call(i,{name:"viewAllLink",hash:{},data:s}):t)+'" class="view-more-link" data-track="search-viewall">'+o((e.intlHTMLMessage||l&&l.intlHTMLMessage||r).call(i,{name:"intlHTMLMessage",hash:{count:null!=l?l.photoCount:l,intlName:"search.VIEW_ALL_COUNT"},data:s}))+"</a>"},11:function(n,l,e,a,s){var t;return null!=(t=e.if.call(null!=l?l:{},null!=l?l.validResults:l,{name:"if",hash:{},fn:n.program(12,s,0),inverse:n.noop,data:s}))?t:""},12:function(n,l,e,a,s){return"\t\t"+n.escapeExpression((e.outlet||l&&l.outlet||e.helperMissing).call(null!=l?l:{},null!=l?l["photo-list-view"]:l,{name:"outlet",hash:{},data:s}))+"\n"},compiler:[7,">= 4.0.0"],main:function(n,l,e,a,s){var t,i=null!=l?l:{};return(null!=(t=e.if.call(i,null!=l?l.validResults:l,{name:"if",hash:{},fn:n.program(1,s,0),inverse:n.noop,data:s}))?t:"")+(null!=(t=e.unless.call(i,null!=l?l.loading:l,{name:"unless",hash:{},fn:n.program(11,s,0),inverse:n.noop,data:s}))?t:"")},useData:!0}),a={};n.Array.each([],function(l){var e=n.Template.get("hermes/"+l);e&&(a[l]=e)}),n.Template.register("hermes/search-photos-everyone-view",function(l,s){return s=s||{},s.partials=s.partials?n.merge(a,s.partials):a,e(l,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("search-photos-everyone-view",function(e){var i={"photo-models":{name:"photo-list-photo-view",params:{excludePeople:!0,searchSimilar:!0,searchSimilarWithTerm:!0}},"photo-lite-models":{name:"photo-list-photo-view",params:{excludePeople:!0,searchSimilar:!0,searchSimilarWithTerm:!0}}},t={jst:{rowHeight:170,subviewMapping:i},thm:{rowHeight:120,forceAspectRatio:1,subviewMapping:i},til:{rowHeight:210,forceAspectRatio:1,loadMoreMargin:5,subviewMapping:{"photo-models":{name:"photo-list-tile-view",params:{excludePeople:!0,showDescription:!1,searchSimilar:!0,searchSimilarWithTerm:!0}},"photo-lite-models":{name:"photo-list-tile-view",params:{excludePeople:!0,showDescription:!1,searchSimilar:!0,searchSimilarWithTerm:!0}}}},desc:{rowHeight:210,itemSpacing:{horizontal:4,vertical:70},subviewMapping:{"photo-models":{name:"photo-list-description-view"},"photo-lite-models":{name:"photo-list-description-view"}}}};e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(i){var a,s,o,r,h,p;if(h=i.rowHeightMod||1,"til"===i.viewType&&(h=Math.max(1,i.rowHeightMod)),""===this.get("container").get("innerHTML")&&this.setContainerWithTemplate("search-photos-everyone-view",{loading:!0}),i.viewType||(i.viewType="jst"),this.unifiedSubviewParams=i.unifiedSubviewParams||{},this.unifiedSubviewParams.everyone&&this.unifiedSubviewParams.everyone.fetchParams?(this.fetchParams=this.unifiedSubviewParams.everyone.fetchParams,this.apiParams=e.merge(this.fetchParams.apiParams||{}),this.searchId=this.unifiedSubviewParams.everyone.id):(this.apiParams={},this.fetchParams={}),this.searchUrl=new e.SearchUrl(this.apiParams,this.appContext,e.SearchUrl.searchTypes.PHOTOS),a=t[i.viewType].forceAspectRatio,s=t[i.viewType].loadMoreMargin,o=e.clone(t[i.viewType].subviewMapping),r=e.clone(t[i.viewType].itemSpacing),this.apiFailed=i.apiFailed,i.photoListConfig={modelParams:{registryName:"search-photos-lite-models",modelIdOrAttributes:this.searchId||this.searchUrl.getId(),collectionAttributeName:"photos",fetchParams:this.fetchParams},pageParams:{page:1,perPage:50,perPageDoubling:1},parentName:this.name,loadMoreMargin:3,engagementModelName:"photo-lite-models",injectPhotolistContextParams:{rapidBeaconConfig:{beaconName:"searchPhotoResultClick",itemIndexKey:"vespaRnk"}},measureAFT:!0,mobileLayout:i.allowMobileLayout?{}:null,scrollInterruptParams:{pageCounts:[5],footerToHideWhileScrolling:".footer-full-view"},layout:{containerPadding:{top:0,right:0,bottom:8,left:0},targetRowHeight:t[i.viewType].rowHeight*h,awakeBoundsToViewportSizeRatio:5}},a&&(i.photoListConfig.layout.forceAspectRatio=a),s&&(i.photoListConfig.layout.loadMoreMargin=s),o){if(i.photoListConfig.subviewMapping=o,this.searchUrl.getAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll)&&this.searchUrl.getAPIParam(e.SearchHelper.API.userId)||!this.appContext.flipper.isFlipped("search-exclude-people")||i.suppressExcludePeople)for(p in o)i.photoListConfig.subviewMapping[p].params&&(i.photoListConfig.subviewMapping[p].params.excludePeople=!1);if(!this.appContext.flipper.isFlipped("enable-similarity-search"))for(p in o)i.photoListConfig.subviewMapping[p].params&&(i.photoListConfig.subviewMapping[p].params.searchSimilar=!1);if(!this.appContext.flipper.isFlipped("enable-similarity-search-with-term"))for(p in o)i.photoListConfig.subviewMapping[p].params&&(i.photoListConfig.subviewMapping[p].params.searchSimilarWithTerm=!1)}return r&&(i.photoListConfig.layout.itemSpacing=r),i.viewType===e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.justified&&(i.photoListConfig.layout.itemSpacing={horizontal:4,vertical:4}),this.rowHeightMod=i.rowHeightMod,this},subviewConfig:{"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return this.apiFailed}}},loadState:function(){var i=this;return this.apiFailed?e.Promise.resolve():this.appContext.getModel("search-photos-lite-models",this.searchId||this.searchUrl.getId(),this.fetchParams).then(function(t){return i.searchModel=t,e.SearchHelper.deriveScopeTitle(i.apiParams,i.appContext)}).then(function(e){i.scopeTitle=i.intlMessage(e)})},buildContainer:function(){return this.setContainerWithTemplate("search-photos-everyone-view",{validResults:this.searchModel&&this.searchModel.getValue("totalItems")>0,photoListTitle:this.scopeTitle,viewAllLink:this.searchUrl.clone().setAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll,!0).getURL(),photoCount:this.apiFailed?"":this.searchModel.getValue("totalItems"),singleResult:!this.apiFailed&&1===this.searchModel.getValue("totalItems"),"photo-list-view":this.apiFailed?"":this.subviews["photo-list-view"].get("container"),viewAll:this.apiParams[e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll]}),this},buildHeadContainer:function(){this.subviews["photo-list-view"]&&this.set("headContainer",this.subviews["photo-list-view"].get("headContainer"))},activate:function(){return this},onParentViewEvent:function(e,i){switch(i&&i.length&&i[0]){case"search:layoutChange":i[1]&&this.handleLayoutChange(i[1])}},handleLayoutChange:function(i){var a,s=this.subviews["photo-list-view"],o=s.photoListLayout,r=t[i].forceAspectRatio,h=t[i].loadMoreMargin,p=e.clone(t[i].subviewMapping),l=this.rowHeightMod;if(t.hasOwnProperty(i)){if("til"===i&&(l=Math.max(1,l)),o.targetRowHeight=t[i].rowHeight*l,o.forceAspectRatio=r,o.loadMoreMargin=h,s.subviewMapping=p,!this.appContext.flipper.isFlipped("search-exclude-people"))for(a in p)s.subviewMapping[a].params.excludePeople=!1;if(!this.appContext.flipper.isFlipped("enable-similarity-search"))for(a in p)s.subviewMapping[a].params.searchSimilar=!1;if(!this.appContext.flipper.isFlipped("enable-similarity-search-with-term"))for(a in p)s.subviewMapping[a].params.searchSimilarWithTerm=!1;s.setItems(this.searchModel.getValue("photos").getList())}}})},"@VERSION@",{requires:["flickr-view","photo-list-view","flickr-promise","search-url","hermes-template-search-photos-everyone-view","search-helper","flutil","search-photos-lite-models","person-preferences-models"],langBundles:["search"]});YUI.add("hermes-template-feedback-widget",function(e,a){var l=e.Template.Handlebars.revive({1:function(e,a,l,n,r){var t;return' data-track="'+e.escapeExpression("function"==typeof(t=null!=(t=l.trackingSlk||(null!=a?a.trackingSlk:a))?t:l.helperMissing)?t.call(null!=a?a:{},{name:"trackingSlk",hash:{},data:r}):t)+'"'},compiler:[7,">= 4.0.0"],main:function(e,a,l,n,r){var t,s,i=null!=a?a:{},c=l.helperMissing,f=e.escapeExpression;return'<a href="'+f("function"==typeof(s=null!=(s=l.feedbackUrl||(null!=a?a.feedbackUrl:a))?s:c)?s.call(i,{name:"feedbackUrl",hash:{},data:r}):s)+'" class="feedback-link"'+(null!=(t=l.if.call(i,null!=a?a.trackingSlk:a,{name:"if",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?t:"")+'><i class="feedback-icon">&nbsp;</i>'+f((l.intlMessage||a&&a.intlMessage||c).call(i,{name:"intlMessage",hash:{intlName:"feedback.FEEDBACK_LINK"},data:r}))+"</a>\n"},useData:!0}),n={};e.Array.each([],function(a){var l=e.Template.get("hermes/"+a);l&&(n[a]=l)}),e.Template.register("hermes/feedback-widget",function(a,r){return r=r||{},r.partials=r.partials?e.merge(n,r.partials):n,l(a,r)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("feedback-widget-view",function(e){e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.set("feedbackUrl",e.feedbackUrl),this.set("trackingSlk",e.trackingSlk),this.set("hidden",e.hidden||!1)},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("feedback-widget",{feedbackUrl:this.get("feedbackUrl"),trackingSlk:this.get("trackingSlk")}),this.get("hidden")&&this.get("container").addClass("hidden"),this},activate:function(){var t=e.one(".footer-full-view"),i=t?t.one("footer.foot"):null;return this.set("footerContainer",t),this.set("footer",i),this.registerEventHandler(e.globalEvents.subscribe("window:scroll",this.updateWidgetPosition.bind(this))),this.registerEventHandler(e.globalEvents.subscribe("window:resize",this.updateWidgetPosition.bind(this))),this.updateWidgetPosition(),this},onParentViewEvent:function(e,t){switch(t&&t.length&&t[0]){case"footerDisplayChanged":this.updateWidgetPosition();break;case"unhideFeedbackWidget":this.get("container").removeClass("hidden")}},updateWidgetPosition:function(t){var i;this.get("footer")&&(i=e.config.win.pageYOffset+this.appContext.viewportData.getHeight(),"none"!==this.get("footerContainer").getComputedStyle("display")&&i>=this.get("footer").getY()?this.get("container").hasClass("hugging-footer")||this.get("container").addClass("hugging-footer"):this.get("container").hasClass("hugging-footer")&&this.get("container").removeClass("hugging-footer"))}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-feedback-widget"],langBundles:["feedback"]});YUI.add("hermes-lang-feedback",function(e,a){e.Intl.add("hermes/feedback","en-US",{HELP_AND_FEEDBACK:["Help &amp; Feedback"],FEEDBACK_LINK:["Feedback"],FAQS_LINK:["FAQs"],OPT_OUT_LINK:["Opt out of the new Photo Experience"]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-template-footer-full",function(e,t){var l=e.Template.Handlebars.revive({1:function(e,t,l,a,n){var s,o=null!=t?t:{};return'\t\t<div class="foot-top-row">\n\t\t\t<ul class="foot-nav-ul">\n'+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.top_about:s,{name:"if",hash:{},fn:e.program(2,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.top_jobs:s,{name:"if",hash:{},fn:e.program(4,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.top_blog:s,{name:"if",hash:{},fn:e.program(6,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.top_mobile:s,{name:"if",hash:{},fn:e.program(8,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.top_developers:s,{name:"if",hash:{},fn:e.program(10,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.top_guidelines:s,{name:"if",hash:{},fn:e.program(12,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.top_privacy:s,{name:"if",hash:{},fn:e.program(14,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.top_terms:s,{name:"if",hash:{},fn:e.program(16,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.top_yahoo_safely:s,{name:"if",hash:{},fn:e.program(18,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.top_feedback:s,{name:"if",hash:{},fn:e.program(20,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.top_report_abuse:s,{name:"if",hash:{},fn:e.program(22,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.top_help_forum:s,{name:"if",hash:{},fn:e.program(24,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.top_language:s,{name:"if",hash:{},fn:e.program(26,n,0),inverse:e.noop,data:n}))?s:"")+"\t\t\t</ul>\n\t\t</div>\n"},2:function(e,t,l,a,n){return'\t\t\t\t<li class="foot-li"><a href="/about" data-track="footer-about">'+e.escapeExpression((l.intlMessage||t&&t.intlMessage||l.helperMissing).call(null!=t?t:{},{name:"intlMessage",hash:{intlName:"common.ABOUT"},data:n}))+"</a></li>\n"},4:function(e,t,l,a,n){return'\t\t\t\t<li class="foot-li"><a href="/jobs" data-track="footer-jobs">'+e.escapeExpression((l.intlMessage||t&&t.intlMessage||l.helperMissing).call(null!=t?t:{},{name:"intlMessage",hash:{intlName:"common.JOBS"},data:n}))+"</a></li>\n"},6:function(e,t,l,a,n){return'\t\t\t\t<li class="foot-li"><a href="//blog.flickr.net/en" data-track="footer-blog">'+e.escapeExpression((l.intlMessage||t&&t.intlMessage||l.helperMissing).call(null!=t?t:{},{name:"intlMessage",hash:{intlName:"common.BLOG"},data:n}))+"</a></li>\n"},8:function(e,t,l,a,n){return'\t\t\t\t<li class="foot-li"><a href="//mobile.yahoo.com/flickr" data-track="footer-mobile">'+e.escapeExpression((l.intlMessage||t&&t.intlMessage||l.helperMissing).call(null!=t?t:{},{name:"intlMessage",hash:{intlName:"common.MOBILE"},data:n}))+"</a></li>\n"},10:function(e,t,l,a,n){return'\t\t\t\t<li class="foot-li"><a href="/services/developer" data-track="footer-developers">'+e.escapeExpression((l.intlMessage||t&&t.intlMessage||l.helperMissing).call(null!=t?t:{},{name:"intlMessage",hash:{intlName:"common.DEVELOPERS"},data:n}))+"</a></li>\n"},12:function(e,t,l,a,n){return'\t\t\t\t<li class="foot-li"><a href="/help/guidelines" data-track="footer-guidelines">'+e.escapeExpression((l.intlMessage||t&&t.intlMessage||l.helperMissing).call(null!=t?t:{},{name:"intlMessage",hash:{intlName:"common.GUIDELINES"},data:n}))+"</a></li>\n"},14:function(e,t,l,a,n){return'\t\t\t\t<li class="foot-li"><a href="//policies.yahoo.com/privacy/flickr" data-track="footer-privacy">'+e.escapeExpression((l.intlMessage||t&&t.intlMessage||l.helperMissing).call(null!=t?t:{},{name:"intlMessage",hash:{intlName:"common.PRIVACY"},data:n}))+"</a></li>\n"},16:function(e,t,l,a,n){return'\t\t\t\t<li class="foot-li"><a href="/help/terms" data-track="footer-terms">'+e.escapeExpression((l.intlMessage||t&&t.intlMessage||l.helperMissing).call(null!=t?t:{},{name:"intlMessage",hash:{intlName:"common.TERMS"},data:n}))+"</a></li>\n"},18:function(e,t,l,a,n){return'\t\t\t\t<li class="foot-li"><a href="//safely.yahoo.com" data-track="footer-safely">'+e.escapeExpression((l.intlMessage||t&&t.intlMessage||l.helperMissing).call(null!=t?t:{},{name:"intlMessage",hash:{intlName:"common.YAHOO_SAFELY"},data:n}))+"</a></li>\n"},20:function(e,t,l,a,n){return'\t\t\t\t<li class="foot-li"><a href="//yahoo.uservoice.com/forums/211185-us-flickr" data-track="footer-feedback">'+e.escapeExpression((l.intlMessage||t&&t.intlMessage||l.helperMissing).call(null!=t?t:{},{name:"intlMessage",hash:{intlName:"common.FEEDBACK"},data:n}))+"</a></li>\n"},22:function(e,t,l,a,n){return'\t\t\t\t<li class="foot-li"><a href="/abuse" data-track="footer-abuse">'+e.escapeExpression((l.intlMessage||t&&t.intlMessage||l.helperMissing).call(null!=t?t:{},{name:"intlMessage",hash:{intlName:"common.REPORT_ABUSE"},data:n}))+"</a></li>\n"},24:function(e,t,l,a,n){return'\t\t\t\t<li class="foot-li"><a href="/help/forum" data-track="footer-forum">'+e.escapeExpression((l.intlMessage||t&&t.intlMessage||l.helperMissing).call(null!=t?t:{},{name:"intlMessage",hash:{intlName:"common.HELP_FORUM"},data:n}))+"</a></li>\n"},26:function(e,t,l,a,n){var s,o=e.lambda,i=e.escapeExpression;return'\t\t\t\t<li class="foot-li lang-switcher">\n\t\t\t\t\t<a href="/change_language.gne?lang='+i(o(null!=(s=null!=t?t.selectedLang:t)?s.code:s,t))+"&csrf="+i(o(null!=(s=null!=t?t.selectedLang:t)?s.csrf:s,t))+'" data-track="footer-language">'+i(o(null!=(s=null!=t?t.selectedLang:t)?s.name:s,t))+'</a>\n\t\t\t\t\t<span class="arrow"></span>\n\t\t\t\t</li>\n'},28:function(e,t,l,a,n){var s,o=null!=t?t:{};return'\t\t<div class="foot-bottom-row">\n\t\t\t<div class="foot-yahoo">\n\t\t\t\t<ul class="foot-nav-ul">\n'+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.bottom_privacy:s,{name:"if",hash:{},fn:e.program(29,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.bottom_terms:s,{name:"if",hash:{},fn:e.program(31,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.bottom_yahoo_safely:s,{name:"if",hash:{},fn:e.program(34,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.bottom_help:s,{name:"if",hash:{},fn:e.program(36,n,0),inverse:e.noop,data:n}))?s:"")+"\t\t\t\t</ul>\n\t\t\t</div>\n\n"+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.bottom_yahoo_company:s,{name:"if",hash:{},fn:e.program(38,n,0),inverse:e.noop,data:n}))?s:"")+'\n\t\t\t<div class="foot-social">\n\t\t\t\t<ul class="foot-nav-ul">\n'+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.bottom_tumblr:s,{name:"if",hash:{},fn:e.program(40,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.bottom_facebook:s,{name:"if",hash:{},fn:e.program(42,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.bottom_twitter:s,{name:"if",hash:{},fn:e.program(44,n,0),inverse:e.noop,data:n}))?s:"")+"\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n"},29:function(e,t,l,a,n){return'\t\t\t\t\t<li class="foot-li"><a href="//policies.yahoo.com/privacy/flickr" data-track="footer-privacy">'+e.escapeExpression((l.intlMessage||t&&t.intlMessage||l.helperMissing).call(null!=t?t:{},{name:"intlMessage",hash:{intlName:"common.PRIVACY"},data:n}))+"</a></li>\n"},31:function(e,t,l,a,n){var s,o=null!=t?t:{};return'\t\t\t\t\t<li class="foot-li"><a href="/help/terms" data-track="footer-terms"'+(null!=(s=l.if.call(o,null!=t?t.highlightTerms:t,{name:"if",hash:{},fn:e.program(32,n,0),inverse:e.noop,data:n}))?s:"")+">"+e.escapeExpression((l.intlMessage||t&&t.intlMessage||l.helperMissing).call(o,{name:"intlMessage",hash:{intlName:"common.TERMS"},data:n}))+"</a></li>\n"},32:function(e,t,l,a,n){return' class="highlighted"'},34:function(e,t,l,a,n){return'\t\t\t\t\t<li class="foot-li"><a href="//safely.yahoo.com" data-track="footer-safely">'+e.escapeExpression((l.intlMessage||t&&t.intlMessage||l.helperMissing).call(null!=t?t:{},{name:"intlMessage",hash:{intlName:"common.YAHOO_SAFELY"},data:n}))+"</a></li>\n"},36:function(e,t,l,a,n){var s,o=null!=t?t:{},i=l.helperMissing,r=e.escapeExpression;return'\t\t\t\t\t<li class="foot-li"><a href="//help.yahoo.com/kb/index?page=product&locale='+r("function"==typeof(s=null!=(s=l.helpLocaleKey||(null!=t?t.helpLocaleKey:t))?s:i)?s.call(o,{name:"helpLocaleKey",hash:{},data:n}):s)+'&y=PROD_FLICKR_DESK&actp=productlink" data-track="footer-help">'+r((l.intlMessage||t&&t.intlMessage||i).call(o,{name:"intlMessage",hash:{intlName:"common.HELP"},data:n}))+"</a></li>\n"},38:function(e,t,l,a,n){return'\t\t\t<div class="foot-company">\n\t\t\t\t'+e.escapeExpression((l.intlHTMLMessage||t&&t.intlHTMLMessage||l.helperMissing).call(null!=t?t:{},{name:"intlHTMLMessage",hash:{intlName:"common.A_YAHOO_COMPANY_WITH_LINK"},data:n}))+"\n\t\t\t</div>\n"},40:function(e,t,l,a,n){return'\t\t\t\t\t<li><a target="_blank" href="http://flickr.tumblr.com/" aria-label="Tumblr" data-track="footer-tumblr">\n\t\t\t\t\t\t<svg class="ft-icon ft-tumblr"><use xlink:href="#icon-tumblr"></use></svg>\n\t\t\t\t\t</a></li>\n'},42:function(e,t,l,a,n){return'\t\t\t\t\t<li><a target="_blank" href="https://www.facebook.com/flickr" aria-label="Facebook" data-track="footer-facebook">\n\t\t\t\t\t\t<svg class="ft-icon ft-facebook"><use xlink:href="#icon-facebook"></use></svg>\n\t\t\t\t\t</a></li>\n'},44:function(e,t,l,a,n){return'\t\t\t\t\t<li><a target="_blank" href="https://twitter.com/flickr" aria-label="Twitter" data-track="footer-twitter">\n\t\t\t\t\t\t<svg class="ft-icon ft-twitter"><use xlink:href="#icon-twitter"></use></svg>\n\t\t\t\t\t</a></li>\n'},compiler:[7,">= 4.0.0"],main:function(e,t,l,a,n){var s,o=null!=t?t:{};return e.escapeExpression((l.outlet||t&&t.outlet||l.helperMissing).call(o,null!=t?t["privacy-footer-view"]:t,{name:"outlet",hash:{},data:n}))+'\n\n<footer class="foot">\n\t<div class="foot-container" role="contentinfo">\n'+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.top_row:s,{name:"if",hash:{},fn:e.program(1,n,0),inverse:e.noop,data:n}))?s:"")+(null!=(s=l.if.call(o,null!=(s=null!=t?t.elements:t)?s.bottom_row:s,{name:"if",hash:{},fn:e.program(28,n,0),inverse:e.noop,data:n}))?s:"")+'\t</div>\n</footer>\n\n<span id="tgt"><div id="tgtRS"></div></span>\n'},useData:!0}),a={};e.Array.each([],function(t){var l=e.Template.get("hermes/"+t);l&&(a[t]=l)}),e.Template.register("hermes/footer-full",function(t,n){return n=n||{},n.partials=n.partials?e.merge(a,n.partials):a,l(t,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("dropdown",function(e){"use strict";var t;t={css:{closed:"ui-dropdown-closed",shim:"ui-dropdown-shim",label:'span[data-action="toggle"]',items:"[data-value]",itemSelected:"ui-dropdown-item-selected",hasDialogArrow:"ui-dropdown-has-dialog-arrow",dialogArrow:"ui-dialog-arrow",useCheckMarks:"ui-dropdown-use-checkboxes"},options:{hasDialogArrow:!1,useCheckMarks:!1}},e.namespace("Views").Dropdown=e.Base.create("Dropdown",e.FlickrView,[],{initializer:function(e){!1!==e.activate&&this.activate()},activate:function(){var s,i=this,a=this.get("container");if(this.close(),this._items={},e.Lang.isArray(this.get("selected"))||this.set("selected",[this.get("selected")]),a.all(t.css.items).each(function(e){var t=e.getData();i._items[t.value]={text:t.text||'no data-text for "'+t.value+'"',sub:t.sub,node:e}}),this.labelEl=a.one(t.css.label),this.labelEl||(this.labelEl=e.Node.create('<span class="truncate" data-action="toggle" tabindex="0" aria-haspopup="true" aria-expanded="false" />'),a.insert(this.labelEl,0)),(s=this.get("staticLabel")||this.get("defaultLabel"))&&(!0===s?this.labelEl.set("text","set staticLabel/defaultLabel to a string, not `true`"):this.labelEl.set("text",s)),this.get("hasDialogArrow")&&!a.hasClass(t.css.hasDialogArrow)&&a.addClass(t.css.hasDialogArrow),a.hasClass(t.css.hasDialogArrow)&&(this.dialogArrowEl=a.one(t.css.dialogArrow),this.dialogArrowEl||(this.dialogArrowEl=e.Node.create('<span class="ui-dialog-arrow" />'),a.insert(this.dialogArrowEl,1))),this.get("useCheckMarks")&&!a.hasClass(t.css.useCheckMarks)&&a.addClass(t.css.useCheckMarks),this.select(),this.get("disabled"))return this.disable();this.attachEvents({":toggle":this.toggle.bind(this),":set":this.setData.bind(this)}),this.registerEventHandler(this.labelEl.on("key",this.toggle,"down:13",this)),this.registerEventHandler(this.labelEl.on("key",this.enterDropdown,"down:40",this));var l=this.labelEl.next("ul");l&&(this.registerEventHandler(l.on("keydown",this.keyboardNavigation,this)),this.registerEventHandler(l.delegate("key",function(e){document.activeElement.dataset&&this.setData(e,document.activeElement.dataset)},"down:13","li",this)))},setData:function(t,s){if(t.halt(),!this.get("multiSelect")&&!this.get("multiSelectSub")&&e.Array.indexOf(this.get("selected"),s.value)>=0)return this.close();this.select(s.value,s)},select:function(s,i,a){var l,n=this,h=s?this._items[s]:null,o=!0,c=[];h&&e.Array.indexOf(this.get("selected"),s)>=0&&(this.get("multiSelect")||this.get("multiSelectSub"))?(c=this.get("selected"),!h.sub&&this.get("multiSelect")&&c.length>this.get("minimumSelected")?(c.splice(e.Array.indexOf(this.get("selected"),s),1),o=!1):h.sub&&(c.splice(e.Array.indexOf(this.get("selected"),s),1),o=!1),this.set("selected",c)):h&&(h.sub?(c.push(s),this.get("selectParent")&&c.push(h.sub),e.Array.each(this.get("selected"),function(e){n._items[e].sub===h.sub?c.push(e):n.get("multiSelect")&&!n._items[e].sub&&c.push(e)})):this.get("multiSelect")?(c=this.get("selected")).push(s):c.push(s),this.set("selected",c)),a||this.close(),l={clicked:h?{text:h.text,value:s,sub:h.sub,itemEl:h.node,isChecked:o}:null,data:i,selections:c},this.fire("selected",l),this.update(s,l,t)},update:function(t,s,i){var a=this,l=s.clicked,n=this.get("selected"),h=this.get("defaultLabel")||"[Unable to select a default item]";this.get("staticLabel")||(this.get("labelFunction")?h=this.get("labelFunction").apply(this,[t]):l?h=s.data&&s.data.text&&s.data.text!==l.text?s.data.text:l.text:n.length>0&&a._items[n[0]]&&(h=a._items[n[0]].text),this.labelEl.set("textContent",h||"[!empty data-text!]")),this.get("container").all(i.css.items).removeClass(i.css.itemSelected),e.Array.each(n,function(e){a._items[e]&&a._items[e].node.addClass(i.css.itemSelected)})},toggle:function(e){e&&e.halt(),this._open?this.close(e):this.open(e)},open:function(e){var s=this.get("container"),i=0;this._open=!0,this.get("shouldCreateShim")&&this._shimUp(),s.removeClass(t.css.closed),this.get("autoSizeMenu")&&(i=parseInt(this.labelEl.getComputedStyle("width"),10))+30>parseInt(s.one("ul").getComputedStyle("width"),10)&&s.one("ul").setStyles({width:i+30}),e&&e.silent||this.fire("open",e);var a=s.one("span:first-child");a&&a.setAttribute("aria-expanded","true")},close:function(e){var s=this.get("container");e&&e.halt(),this._open=!1,this._shimUp(!1),this.fire("close",e),s.addClass(t.css.closed);var i=this.labelEl;i&&i.setAttribute("aria-expanded","false")},enterDropdown:function(e){e.preventDefault();var t=this.labelEl.next("ul").one("li");t&&t.focus()},keyboardNavigation:function(e){var t=e.keyCode,s=38===t||9===t&&e.shiftKey,i=40===t||9===t&&!e.shiftKey,a=e.target.ancestor("li",!0);s&&a&&a.previous("li")?(e.preventDefault(),this.focusOnPreviousItem(e)):i?(e.preventDefault(),a&&a.next("li")&&this.focusOnNextItem(e)):(27===t||s)&&(e.preventDefault(),this.labelEl&&(this.labelEl.focus(),this.close()))},focusOnPreviousItem:function(e){var t=e.target.ancestor("li",!0);if(t){var s=t.previous("li");s&&(s.one("a")?s.one("a").focus():s.focus())}},focusOnNextItem:function(e){var t=e.target.ancestor("li",!0);if(t){var s=t.next("li");s&&(s.one("a")?s.one("a").focus():s.focus())}},_shimUp:function(s){if(!1===s){if(!this._shim)return;return this._shim.detach("click").remove(),void(this._shim=null)}this._shim=e.Node.create("<div />"),this._shim.addClass(t.css.shim),this._shim.on("click",this.close.bind(this)),this.get("container").appendChild(this._shim)},disable:function(){var e=this.get("container");this.set("disabled",!0),this.close(),e.addClass(t.css.disabled),e.detach()},destructor:function(){this._shimUp(!1),this._items=null,this.labelEl=null,this.set("selected",null),this.detachAll()}},{ATTRS:{selected:{value:[]},disabled:{value:!1},hasDialogArrow:{value:!1},useCheckMarks:{value:!1},multiSelect:{value:!1},multiSelectSub:{value:!1},selectParent:{value:!0},minimumSelected:{value:0},staticLabel:{value:!1},defaultLabel:{value:!1},labelFunction:function(){},shouldCreateShim:{value:!0},autoSizeMenu:{value:!0}}})},"@VERSION@",{requires:["flickr-view"]});YUI.add("hermes-template-privacy-footer",function(e,a){var t=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,t,n,s){var l,i=null!=a?a:{},r=t.helperMissing,o=e.escapeExpression;return'<div class="footer-container">\n\t<div class="footer-content">\n\t\t<p>'+o((t.intlMessage||a&&a.intlMessage||r).call(i,{name:"intlMessage",hash:{intlName:"privacy.OATH_DATA_USAGE"},data:s}))+' <a href="'+o("function"==typeof(l=null!=(l=t.url||(null!=a?a.url:a))?l:r)?l.call(i,{name:"url",hash:{},data:s}):l)+'">'+o((t.intlMessage||a&&a.intlMessage||r).call(i,{name:"intlMessage",hash:{intlName:"common.LEARN_MORE"},data:s}))+'</a></p>\n\t\t<button class="dismiss">'+o((t.intlMessage||a&&a.intlMessage||r).call(i,{name:"intlMessage",hash:{intlName:"common.DISMISS"},data:s}))+"</button>\n\t</div>\n</div>\n"},useData:!0}),n={};e.Array.each([],function(a){var t=e.Template.get("hermes/"+a);t&&(n[a]=t)}),e.Template.register("hermes/privacy-footer",function(a,s){return s=s||{},s.partials=s.partials?e.merge(n,s.partials):n,t(a,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("privacy-footer-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,buildContainer:function(){var e=this.appContext.lang.substring(0,2),i=-1!==["en","nl","es","fr","pt","de","it"].indexOf(e)?e:"en";return this.setContainerWithTemplate("privacy-footer",{url:"https://policies.yahoo.com/ie/"+i+"/yahoo/privacy/euoathnoticefaq"}),this}})},"@VERSION@",{requires:["flickr-view","hermes-template-privacy-footer"],langBundles:["common","privacy"]});YUI.add("hermes-lang-privacy",function(e,n){e.Intl.add("hermes/privacy","en-US",{OATH_DATA_USAGE:["Flickr and Yahoo are now part of “Oath” and are members of the Verizon family of companies. Beginning 15 September 2017, we plan to share some user information within our new family."]})},"@VERSION@",{requires:["intl"]});YUI.add("footer-full-view",function(e){var t=["en-US","zh-HK","de-DE","es-US","fr-FR","ko-KR","it-IT","pt-BR","vn-VN","id-ID"],o={"en-US":"English","de-DE":"Deutsch","es-US":"Español","fr-FR":"Français","ko-KR":"한글","it-IT":"Italiano","pt-BR":"Português","vn-VN":"Tiếng Việt","id-ID":"Bahasa Indonesia","zh-HK":"繁體中文"};e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return""===this.get("container").get("innerHTML")&&this.setContainerHTML('<div class="footer-full-content"></div>'),this.appStateParams=e,this},subviewConfig:{"privacy-footer-view":{requiredToShowOnServer:!1,requiredToShowOnClient:!1,additionalViewClasses:["hidden"],disabled:function(){return!this.appContext.flipper.isFlipped("enable-privacy-footer")}}},loadState:function(){var a,i,n;for(n=this.appContext.auth&&this.appContext.auth.csrf?this.appContext.auth.csrf:"",this.lang=this.appContext.lang,this.menuLangs=[],"zh-Hant-HK"===this.lang&&(this.lang="zh-HK"),"vi-vn"===this.lang.toLowerCase()&&(this.lang="vn-VN"),this.selectedLang={code:this.lang,name:o[this.lang],csrf:n},a=0,i=t.length;a<i;a++)t[a]!==this.lang&&"string"==typeof t[a]&&this.menuLangs.push({code:t[a].toLowerCase(),name:o[t[a]],csrf:n});return e.Promise.resolve()},buildContainer:function(){var t={};return this.get("viewer")&&e.merge(this.get("viewer").toJSON(),{urls:e.URLHelper.generatePersonUrls(this.get("viewer"))}),(t={displayLangs:this.displayLangs,selectedLang:this.selectedLang,helpLocaleKey:this.selectedLang.code.replace("-","_")||"en_US",menuLangs:this.menuLangs,elements:this.setElementStates()}).elements.bottom_row||this.get("container").addClass("compact"),YUI.Env.isServer?t.pageUrl=this.appContext.request.url:t.pageUrl=window.location.pathname,this.setContainerWithTemplate("footer-full",t),this},activate:function(){var t=this.get("container"),o=t.one(".lang-switcher"),a=o.one("a");return this.appContext.flipper.isFlipped("enable-privacy-footer")&&(this.appContext.hasClientSideRouted()||e.StorageHelper.hasEntries("privacyFooterDismissed")||!e.config.flickr.geo.eu||t.addClass("privacy-footer"),this.registerEventHandler(t.one(".dismiss").on("click",function(){e.StorageHelper.setItem("privacyFooterDismissed",!0),t.removeClass("privacy-footer")}))),this.menuLangsFormatted=this.menuLangs.map(function(e){return{href:"/change_language.gne?lang="+e.code+"&csrf="+e.csrf,text:e.name}}),this.registerEventHandler(o.on("click",function(t){t.preventDefault(),a.addClass("dimmed");var i=new e.Views.FluidDroparound({anchorOffsetHorizontal:15,appContext:this.appContext,showDropArrow:!0,observePageResize:!0,dismissOnOverlayClick:!0,anchorElement:o.one(".arrow"),classList:["lang-droparound"],menuItems:this.menuLangsFormatted});i.show(),this.registerEventHandler(i.on("closeDroparound",function(e){a.removeClass("dimmed")}),this)},this)),this},setElementStates:function(){var e={top_row:!0,top_about:!0,top_jobs:!0,top_blog:!0,top_mobile:!0,top_developers:!0,top_guidelines:!0,top_privacy:!1,top_terms:!1,top_yahoo_safely:!1,top_feedback:!0,top_report_abuse:!0,top_help_forum:!0,top_language:!0,bottom_row:!0,bottom_privacy:!0,bottom_terms:!0,bottom_yahoo_safely:!0,bottom_help:!0,bottom_yahoo_company:!0,bottom_tumblr:!0,bottom_facebook:!0,bottom_twitter:!0};return this.appStateParams.isSOHP&&(e.top_privacy=!0,e.top_terms=!0,e.top_yahoo_safely=!0,e.top_feedback=!1,e.top_report_abuse=!1,e.bottom_row=!1),e}})},"@VERSION@",{requires:["flickr-view","hermes-template-footer-full","url-helper","dropdown","fluid-droparound-view","privacy-footer-view"],langBundles:["common"]});YUI.add("search-photos-unified-page-view",function(e){var i=e.url("/help/forum/en-us/72157651248603362/lastpage#reply"),s=244;e.namespace("Views")[this.name]=e.Base.create("search-photos-unified-page-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(i){var a,t;return this.appContext.flipper.isFlipped("enable-slender-advanced-search")&&(s=100),this.unifiedSubviewParams=i.unifiedSubviewParams||{},a=this.unifiedSubviewParams.everyone&&this.unifiedSubviewParams.everyone.fetchParams?this.unifiedSubviewParams.everyone.fetchParams.apiParams:{},this.searchUrl=new e.SearchUrl(a,this.appContext,e.SearchUrl.searchTypes.PHOTOS),this.apiParams=this.searchUrl.getAPIParams(),this.advancedPanelOpen=i.openAdvanced||!1,this.isMobile=i.isMobile,this.searchTerm=i.searchTerm,this.apiFailed=i.apiFailed,t=this.name.replace(/-/g,"_"),YUI.Env.isServer&&e.config.flickr.paft_metrics_samples&&e.config.flickr.paft_metrics_samples[t]&&(i.paft=!0),YUI.Env.isServer||this.appContext.clientMetrics.setPendingMeasurement(this.name,!0),i.sortMenuItems=this.buildSortMenuItems(this.apiParams,!this.appContext.flipper.isFlipped("enable-slender-advanced-search")),this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,isSearchResults:!0},"search-subnav-slender-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"search-empty-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-photos-yours-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!this.unifiedSubviewParams.yours}},"search-photos-contacts-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!this.unifiedSubviewParams.contacts}},"search-photos-albums-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!this.unifiedSubviewParams.albums}},"search-slender-advanced-panel-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(e){return e.isMobile}},"search-photos-everyone-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!this.unifiedSubviewParams.everyone}},"feedback-widget-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,feedbackUrl:i,trackingSlk:"search-photos-feedback",hidden:!0},"signup-footer-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,pageType:"search"},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},loadState:function(){var i=this,s={};return this.apiFailed||!this.unifiedSubviewParams?e.Promise.resolve():(this.unifiedSubviewParams.everyone&&(s.everyone=this.appContext.getModel("search-photos-lite-models",this.unifiedSubviewParams.everyone.id,this.unifiedSubviewParams.everyone.fetchParams)),this.unifiedSubviewParams.yours&&(s.yours=this.appContext.getModel("search-photos-lite-models",this.unifiedSubviewParams.yours.id,this.unifiedSubviewParams.yours.fetchParams)),this.unifiedSubviewParams.contacts&&(s.contacts=this.appContext.getModel("search-photos-lite-models",this.unifiedSubviewParams.contacts.id,this.unifiedSubviewParams.contacts.fetchParams)),this.unifiedSubviewParams.albums&&(s.albums=this.appContext.getModel("search-sets-models",this.unifiedSubviewParams.albums.id,this.unifiedSubviewParams.albums.fetchParams)),e.FlickrPromise(s).then(function(e){i.subviewVisibility=i.determineSubviewVisibility(e),i.subviewVisibility.empty&&(e.everyone&&!e.everyone.getValue("emptyQuery")||e.albums&&!e.albums.getValue("emptyQuery"))&&(i.subviews["search-empty-view"].set("noMatchesForQuery",i.buildNoMatchesFoundMessage()),i.subviews["search-empty-view"].fire("parentViewEvent","error-msg-updated")),YUI.Env.isServer||i.beaconIfAllAFTResultsComplete("atfVisible")}))},buildContainer:function(){var i,s=this.appContext.flipper.isFlipped("enable-slender-advanced-search")&&!this.isMobile;return s&&this.subviews["search-slender-advanced-panel-view"]?this.advancedPanelVisible=this.subviews["search-slender-advanced-panel-view"].getStoredAdvancedOptionsState()||this.advancedPanelOpen:this.advancedPanelVisible=!1,i={useSlenderAdvancedPanel:s,showEmpty:!this.subviewVisibility||this.subviewVisibility.empty,showAlbums:this.subviewVisibility&&this.subviewVisibility.albums,showEveryones:this.subviewVisibility&&this.subviewVisibility.everyone,showContacts:this.subviewVisibility&&this.subviewVisibility.contacts,showYours:this.subviewVisibility&&this.subviewVisibility.yours,viewingAll:this.searchUrl.getAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll),advancedPanelVisible:this.advancedPanelVisible},["search-empty-view","search-photos-yours-view","search-photos-albums-view","search-photos-contacts-view","search-photos-everyone-view"].forEach(function(e){this.subviews[e]&&(i[e]=this.subviews[e].get("container"))}.bind(this)),this.setContainerWithTemplate("search-photos-unified-page-view",i),this},buildHeadContainer:function(){var e="",i=this;["search-photos-yours-view","search-photos-albums-view","search-photos-contacts-view","search-photos-everyone-view"].forEach(function(s){i.subviews[s]&&(e+=i.subviews[s].get("headContainer"))}),this.set("headContainer",e)},activate:function(){return this.fire("parentViewEvent","unhideFeedbackWidget"),e.later(100,this,function(){e.use("photo-page-scrappy-view")}),this},determineSubviewVisibility:function(e){var i={everyone:!(!e.everyone||!e.everyone.getValue("totalItems")),yours:!(!e.yours||!e.yours.getValue("totalItems")),contacts:!(!e.contacts||!e.contacts.getValue("totalItems")),albums:!(!e.albums||!e.albums.getValue("totalItems"))};return!this.appContext.flipper.isFlipped("enable-similarity-search")&&this.unifiedSubviewParams&&this.unifiedSubviewParams.everyone&&this.unifiedSubviewParams.everyone.fetchParams&&this.unifiedSubviewParams.everyone.fetchParams.apiParams.similarity_id&&(i.everyone=!1),i.empty=!(i.everyone||i.yours||i.contacts||i.albums),i},buildSortMenuItems:function(i,s){var a=new e.SearchUrl(i,this.appContext).setSearchType(e.SearchUrl.searchTypes.PHOTOS);return[{text:this.intlMessage({intlName:"search.RELEVANT"}),value:e.SearchHelper.API_SORT_OPTIONS.relevant,href:s?a.setAPIParam("sort",e.SearchHelper.API_SORT_OPTIONS.relevant).getURL():null,isDefault:!0},{text:this.intlMessage({intlName:"search.DATE_UPLOADED"}),value:e.SearchHelper.API_SORT_OPTIONS.dateUploaded,href:s?a.setAPIParam("sort",e.SearchHelper.API_SORT_OPTIONS.dateUploaded).getURL():null},{text:this.intlMessage({intlName:"search.DATE_TAKEN"}),value:e.SearchHelper.API_SORT_OPTIONS.dateTaken,href:s?a.setAPIParam("sort",e.SearchHelper.API_SORT_OPTIONS.dateTaken).getURL():null},{text:this.intlMessage({intlName:"search.INTERESTING"}),value:e.SearchHelper.API_SORT_OPTIONS.interesting,href:s?a.setAPIParam("sort",e.SearchHelper.API_SORT_OPTIONS.interesting).getURL():null}]},buildNoMatchesFoundMessage:function(){var i,s,a=this.appContext.getViewer();return s=this.apiParams.user_id?a.signedIn&&this.apiParams.user_id===a.nsid?this.searchTerm?"search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_YOUR":"search.NO_MATCHES_FOR_QUERY_TERM_YOUR":this.searchTerm?"search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_USER":"search.NO_MATCHES_FOR_QUERY_TERM_USER":this.apiParams.contacts?this.searchTerm?"search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_CONTACTS":"search.NO_MATCHES_FOR_QUERY_TERM_CONTACTS":this.apiParams.group_id?this.searchTerm?"search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_GROUP":"search.NO_MATCHES_FOR_QUERY_TERM_GROUP":this.searchTerm?"search.NO_MATCHES_FOR_QUERY_TERM":"search.NO_MATCHES_FOR_QUERY",i=this.searchTerm?this.intlMessage({intlName:s,searchTerm:e.flutil.unescape(this.searchTerm)}):this.intlMessage({intlName:s}),{noMatchesText:i}},onSubviewEvent:function(e,i){if(i){switch(i[0]){case"dirty":case"search:dirty":this.get("container").addClass("dirty");break;case"atfVisible":this.handleAFTResult(e,i);break;case"bigScotch":this.bigScotch(i);break;case"footerDisplayChanged":this.fire("parentViewEvent","footerDisplayChanged");break;case"search:layoutChange":void 0!==i[1]&&this.fire("parentViewEvent","search:layoutChange",i[1]);break;case"search:startAdvancedPanelTransition":void 0!==i[1]&&this.handleAdvancedPanelTransitionStart(i[1]);break;case"search:finishAdvancedPanelTransition":void 0!==i[1]&&this.handleAdvancedPanelTransitionEnd(i[1]);break;default:i[2]&&"toggle-advanced"===i[2]&&this.toggleAdvancedSearch()}}},handleAdvancedPanelTransitionStart:function(i){var a=this.get("container").one("main");i?(!this.showEmpty&&e.config.win.pageYOffset>34||(a.addClass("advanced-panel-transition"),a.addClass("advanced-panel-visible"),e.flutil.onTransitionEnd(a,function(){a.removeClass("advanced-panel-transition")})),this.advancedPanelVisible=!0):(!this.showEmpty&&e.config.win.pageYOffset>s||(a.addClass("advanced-panel-transition"),a.removeClass("advanced-panel-visible"),e.flutil.onTransitionEnd(a,function(){a.removeClass("advanced-panel-transition")})),this.advancedPanelVisible=!1)},handleAdvancedPanelTransitionEnd:function(i){var a,t=this.get("container").one("main");i?!this.showEmpty&&e.config.win.pageYOffset>34&&(t.addClass("advanced-panel-visible"),window.scrollBy(0,s)):!this.showEmpty&&e.config.win.pageYOffset>s&&(a=Math.min(s,e.config.win.document.body.scrollHeight-e.config.win.innerHeight-e.config.win.pageYOffset),t.removeClass("advanced-panel-visible"),window.scrollBy(0,-a))},toggleAdvancedSearch:function(){this.advancedPanelVisible?this.closeAdvancedPanel():this.openAdvancedPanel()},openAdvancedPanel:function(){var i=this.get("container").one(".advanced-search-wrapper"),a=this.get("container").one("main");!this.showEmpty&&e.config.win.pageYOffset>34?(a.addClass("advanced-panel-opening"),i.removeClass("collapsed"),this.subviews["search-slender-advanced-panel-view"].fire("parentViewEvent","open-advanced"),this.advancedPanelVisible=!0,e.flutil.onTransitionEnd(i,function(){a.removeClass("advanced-panel-opening"),a.addClass("advanced-panel-visible"),window.scrollBy(0,s)})):(i.removeClass("collapsed"),a.addClass("advanced-panel-visible"),this.subviews["search-slender-advanced-panel-view"].fire("parentViewEvent","open-advanced"),this.advancedPanelVisible=!0)},closeAdvancedPanel:function(){var i,a=this.get("container").one(".advanced-search-wrapper"),t=this.get("container").one("main");!this.showEmpty&&e.config.win.pageYOffset>s?(t.addClass("advanced-panel-collapsing"),a.addClass("collapsed"),this.subviews["search-slender-advanced-panel-view"].fire("parentViewEvent","collapse-advanced"),this.advancedPanelVisible=!1,i=Math.min(s,e.config.win.document.body.scrollHeight-e.config.win.innerHeight-e.config.win.pageYOffset),e.flutil.onTransitionEnd(a,function(){t.removeClass("advanced-panel-collapsing"),t.removeClass("advanced-panel-visible"),window.scrollBy(0,-i)})):(a.addClass("collapsed"),t.removeClass("advanced-panel-visible"),this.subviews["search-slender-advanced-panel-view"].fire("parentViewEvent","collapse-advanced"),this.advancedPanelVisible=!1)},handleAFTResult:function(e,i){var s=i[0];this.paftResults||(this.paftResults={},this.showYours&&this.subviews["search-photos-yours-view"]&&(this.paftResults["search-photos-yours-view"]={}),this.showContacts&&this.subviews["search-photos-contacts-view"]&&(this.paftResults["search-photos-contacts-view"]={}),this.showEveryones&&this.subviews["search-photos-everyone-view"]&&(this.paftResults["search-photos-everyone-view"]={})),this.paftResults[e]&&(this.paftResults[e][s]=i[1]||(new Date).getTime()),this.beaconIfAllAFTResultsComplete(s)},beaconIfAllAFTResultsComplete:function(i){var s,a=0;this.allResultsReceived||this.paftResults&&"object"==typeof this.paftResults&&(this.showAlbums||delete this.paftResults["search-photos-albums-view"],this.showYours||delete this.paftResults["search-photos-yours-view"],this.showContacts||delete this.paftResults["search-photos-contacts-view"],this.showEveryones||delete this.paftResults["search-photos-everyone-view"],this.allResultsReceived=Object.keys(this.paftResults).every(function(e){return void 0!==(s=this.paftResults[e][i])&&(s>a&&(a=s),!0)}.bind(this)),this.allResultsReceived&&"atfVisible"===i&&(this.appContext.hasClientSideRouted()?(this.appContext.clientMetrics.mark("AFT_CL",a),this.appContext.clientMetrics.mark("AFT",a)):(e.config.win.performance&&e.config.win.performance.timing&&(a-=e.config.win.performance.timing.navigationStart),this.appContext.clientMetrics.record("AFT_SV",a),this.appContext.clientMetrics.record("AFT",a)),this.appContext.clientMetrics.setPendingMeasurement(this.name,!1),this.appContext.clientMetrics.beacon()))},bigScotch:function(i){var s=i&&i[1],a=this.searchUrl.getAPIParam(e.SearchHelper.API.excludeUserId)||"";s&&(a&&(a+=","),a+=s,this.searchUrl.setAPIParam(e.SearchHelper.API.excludeUserId,a),this.appContext.flapp.navigate(this.searchUrl.getURL()))}},{ATTRS:{spaceid:{value:792600534}}})},"@VERSION@",{requires:["url","flutil","flickr-view","flickr-promise","search-helper","hermes-template-search-photos-unified-page-view","search-subnav-slender-view","search-empty-view","search-photos-albums-view","search-photos-yours-view","search-photos-contacts-view","search-slender-advanced-panel-view","search-photos-everyone-view","search-url","feedback-widget-view","footer-full-view","querystring-stringify-simple","search-photos-lite-models"],langBundles:["search"]});